<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Studio for Explanatory Model Analysis • modelStudio</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- dalexverse --><link href="dalexverse.css" rel="stylesheet">
<link href="dalexverse-2.css" rel="stylesheet">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Interactive Studio for Explanatory Model Analysis">
<meta property="og:description" content="Automate the explanatory analysis of machine learning predictive models.
    Generate advanced interactive and animated model explanations in the form of
    a serverless HTML site with only one line of code. This tool is model agnostic,
    therefore compatibile with most of the black box predictive models and frameworks.
    The main function computes various (instance and dataset level) model explanations
    and produces an interactive, customisable dashboard made with D3.js. It consists
    of multiple panels for plots with their short descriptions. Easily save and share 
    the dashboard with others. Tools for model exploration unite with tools for EDA 
    (Exploratory Data Analysis) to give a broad overview of the model behavior.">
<meta property="og:image" content="/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="index.html">modelStudio</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">1.0.2</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette_examples.html">modelStudio - Python &amp; R examples</a>
    </li>
    <li>
      <a href="articles/vignette_modelStudio.html">modelStudio - perks and features</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/modelStudio/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="interactive-studio-for-explanatory-model-analysis-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#interactive-studio-for-explanatory-model-analysis-" class="anchor"></a>Interactive Studio for Explanatory Model Analysis <img src="reference/figures/logo.png" align="right" width="150">
</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The <code>modelStudio</code> package <strong>automates the Explanatory Analysis of Machine Learning predictive models</strong>. Generate advanced interactive and animated model explanations in the form of a <strong>serverless HTML site</strong> with only one line of code. This tool is model agnostic, therefore compatibile with most of the black box predictive models and frameworks (e.g.Â <code>xgboost</code>, <code>caret</code>, <code>mlr/mlr3</code>, <code>h2o</code>, <code>scikit-learn</code>, <code>lightGBM</code>, <code>tensorflow/keras</code>). See examples below.</p>
<p>The main <code><a href="reference/modelStudio.html">modelStudio()</a></code> function computes various (instance and dataset level) model explanations and produces an <strong>interactive, customisable dashboard made with D3.js</strong>. It consists of multiple panels for plots with their short descriptions. Easily <strong>save and share</strong> the dashboard with others. Tools for model exploration unite with tools for EDA (Exploratory Data Analysis) to give a broad overview of the model behavior.</p>
<!--- [explain FIFA19](https://pbiecek.github.io/explainFIFA19/) &emsp; --->
<p><a href="https://pbiecek.github.io/explainFIFA20/"><strong>explain FIFA20</strong></a> â <a href="https://github.com/hbaniecki/transparent_xai/">explain Lung Cancer</a> â <a href="https://modeloriented.github.io/modelStudio/articles/vignette_modelStudio.html#python-scikit-learn-model"><strong>explain Python model</strong></a> â <a href="https://modeloriented.github.io/modelStudio/#more">More Resources</a> â <a href="https://github.com/ModelOriented/modelStudio/issues/54"><strong>FAQ &amp; Troubleshooting</strong></a></p>
<p><img src="reference/figures/short.gif"></p>
<p>The <code>modelStudio</code> package is a part of the <a href="http://drwhy.ai"><strong>DrWhy.AI</strong></a> universe.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># Install from CRAN:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"modelStudio"</span>)

<span class="co"># Install the development version from GitHub:</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"ModelOriented/modelStudio"</span>)</pre></div>
</div>
<div id="simple-demo" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-demo" class="anchor"></a>Simple Demo</h2>
<p>This package bases on <code>DALEX</code> explainers created with <code><a href="https://rdrr.io/pkg/DALEX/man/explain.html">DALEX::explain()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"DALEX"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"modelStudio"</span>)

<span class="co"># Create a model</span>
<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="no">survived</span> ~<span class="no">.</span>,
             <span class="kw">data</span> <span class="kw">=</span> <span class="no">titanic_imputed</span>,
             <span class="kw">family</span> <span class="kw">=</span> <span class="st">"binomial"</span>)

<span class="co"># Wrap it into an explainer        </span>
<span class="no">explainer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DALEX/man/explain.html">explain</a></span>(<span class="no">model</span>,
                     <span class="kw">data</span> <span class="kw">=</span> <span class="no">titanic_imputed</span>,
                     <span class="kw">y</span> <span class="kw">=</span> <span class="no">titanic_imputed</span>$<span class="no">survived</span>,
                     <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Titanic GLM"</span>)

<span class="co"># Pick some data points</span>
<span class="no">new_observations</span> <span class="kw">&lt;-</span> <span class="no">titanic_imputed</span>[<span class="fl">1</span>:<span class="fl">4</span>,]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">new_observations</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Lucas"</span>, <span class="st">"James"</span>, <span class="st">"Thomas"</span>, <span class="st">"Nancy"</span>)

<span class="co"># Make a studio for the model</span>
<span class="fu"><a href="reference/modelStudio.html">modelStudio</a></span>(<span class="no">explainer</span>, <span class="no">new_observations</span>)</pre></div>
<p>Saved output in the form of a HTML file - <a href="https://modeloriented.github.io/modelStudio/demo.html"><strong>Demo Dashboard</strong></a>.</p>
<p><img src="reference/figures/long.gif"></p>
</div>
<div id="r--python-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#r--python-examples" class="anchor"></a>R &amp; Python Examples</h2>
<div class="sourceCode" id="cb3"><pre class="r"><span class="co"># update main dependencies</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"ingredients"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"iBreakDown"</span>)

<span class="co"># packages for explainer objects</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"DALEX"</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"ModelOriented/DALEXtra"</span>)</pre></div>
<div id="xgboost-dashboard" class="section level3">
<h3 class="hasAnchor">
<a href="#xgboost-dashboard" class="anchor"></a>xgboost <a href="https://modeloriented.github.io/modelStudio/xgboost.html">dashboard</a>
</h3>
<div class="sourceCode" id="cb4"><pre class="r"><span class="co"># load packages and data</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">xgboost</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DALEX</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">modelStudio</span>)

<span class="no">data</span> <span class="kw">&lt;-</span> <span class="kw pkg">DALEX</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/DALEX/man/titanic.html">titanic_imputed</a></span>

<span class="co"># split the data</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>), <span class="fl">0.8</span>*<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>))
<span class="no">train</span> <span class="kw">&lt;-</span> <span class="no">data</span>[<span class="no">index</span>, ]
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">data</span>[-<span class="no">index</span>, ]

<span class="no">train_matrix</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="no">survived</span> ~<span class="no">.</span>-<span class="fl">1</span>, <span class="no">train</span>)
<span class="no">test_matrix</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="no">survived</span> ~<span class="no">.</span>-<span class="fl">1</span>, <span class="no">test</span>)

<span class="co"># prepare the model</span>
<span class="no">xgb_matrix</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span>(<span class="no">train_matrix</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">train</span>$<span class="no">survived</span>)
<span class="no">params</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">eta</span> <span class="kw">=</span> <span class="fl">0.01</span>, <span class="kw">subsample</span> <span class="kw">=</span> <span class="fl">0.6</span>, <span class="kw">max_depth</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">min_child_weight</span> <span class="kw">=</span> <span class="fl">3</span>,
               <span class="kw">objective</span> <span class="kw">=</span> <span class="st">"binary:logistic"</span>, <span class="kw">eval_metric</span> <span class="kw">=</span> <span class="st">"auc"</span>)
<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span>(<span class="no">params</span>, <span class="no">xgb_matrix</span>, <span class="kw">nrounds</span> <span class="kw">=</span> <span class="fl">1000</span>)

<span class="co"># create an explainer for the model</span>
<span class="no">explainer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DALEX/man/explain.html">explain</a></span>(<span class="no">model</span>,
                     <span class="kw">data</span> <span class="kw">=</span> <span class="no">test_matrix</span>,
                     <span class="kw">y</span> <span class="kw">=</span> <span class="no">test</span>$<span class="no">survived</span>,
                     <span class="kw">label</span> <span class="kw">=</span> <span class="st">"xgboost"</span>)

<span class="co"># pick observations</span>
<span class="no">new_observation</span> <span class="kw">&lt;-</span> <span class="no">test_matrix</span>[<span class="fl">1</span>:<span class="fl">2</span>,,<span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">new_observation</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>)

<span class="co"># make a studio for the model</span>
<span class="fu"><a href="reference/modelStudio.html">modelStudio</a></span>(<span class="no">explainer</span>,
            <span class="no">new_observation</span>,
            <span class="kw">options</span> <span class="kw">=</span> <span class="fu"><a href="reference/modelStudioOptions.html">modelStudioOptions</a></span>(<span class="kw">margin_left</span> <span class="kw">=</span> <span class="fl">140</span>))</pre></div>
</div>
<div id="caret" class="section level3">
<h3 class="hasAnchor">
<a href="#caret" class="anchor"></a>caret</h3>
<div class="sourceCode" id="cb5"><pre class="r"><span class="co"># load packages and data</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">caret</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DALEX</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">modelStudio</span>)

<span class="no">data</span> <span class="kw">&lt;-</span> <span class="kw pkg">DALEX</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/DALEX/man/titanic.html">titanic_imputed</a></span>

<span class="co"># split the data</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>), <span class="fl">0.8</span>*<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>))
<span class="no">train</span> <span class="kw">&lt;-</span> <span class="no">data</span>[<span class="no">index</span>, ]
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">data</span>[-<span class="no">index</span>, ]

<span class="co"># caret train takes target as factor</span>
<span class="no">train</span>$<span class="no">survived</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">train</span>$<span class="no">survived</span>)

<span class="co"># prepare the model</span>
<span class="no">cv</span> <span class="kw">&lt;-</span> <span class="fu">trainControl</span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"repeatedcv"</span>,
                   <span class="kw">number</span> <span class="kw">=</span> <span class="fl">3</span>,
                   <span class="kw">repeats</span> <span class="kw">=</span> <span class="fl">10</span>)

<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu">train</span>(<span class="no">survived</span> ~ <span class="no">.</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">train</span>,
               <span class="kw">method</span> <span class="kw">=</span> <span class="st">"gbm"</span>,
               <span class="kw">trControl</span> <span class="kw">=</span> <span class="no">cv</span>,
               <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="co"># create an explainer for the model</span>
<span class="no">explainer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DALEX/man/explain.html">explain</a></span>(<span class="no">model</span>,
                     <span class="kw">data</span> <span class="kw">=</span> <span class="no">test</span>,
                     <span class="kw">y</span> <span class="kw">=</span> <span class="no">test</span>$<span class="no">survived</span>,
                     <span class="kw">label</span> <span class="kw">=</span> <span class="st">"caret"</span>)

<span class="co"># pick observations</span>
<span class="no">new_observation</span> <span class="kw">&lt;-</span> <span class="no">test</span>[<span class="fl">1</span>:<span class="fl">2</span>,]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">new_observation</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>)

<span class="co"># make a studio for the model</span>
<span class="fu"><a href="reference/modelStudio.html">modelStudio</a></span>(<span class="no">explainer</span>,
            <span class="no">new_observation</span>)</pre></div>
</div>
<div id="mlrmlr3" class="section level3">
<h3 class="hasAnchor">
<a href="#mlrmlr3" class="anchor"></a>mlr/mlr3</h3>
<div class="sourceCode" id="cb6"><pre class="r"><span class="co"># load packages and data</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DALEXtra</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">modelStudio</span>)

<span class="no">data</span> <span class="kw">&lt;-</span> <span class="kw pkg">DALEX</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/DALEX/man/titanic.html">titanic_imputed</a></span>

<span class="co"># split the data</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>), <span class="fl">0.8</span>*<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>))
<span class="no">train</span> <span class="kw">&lt;-</span> <span class="no">data</span>[<span class="no">index</span>, ]
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">data</span>[-<span class="no">index</span>, ]

<span class="co"># mlr ClassifTask takes target as factor</span>
<span class="no">train</span>$<span class="no">survived</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">train</span>$<span class="no">survived</span>)

<span class="co"># prepare the model</span>
<span class="no">task</span> <span class="kw">&lt;-</span> <span class="fu">makeClassifTask</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"titanic"</span>,
                        <span class="kw">data</span> <span class="kw">=</span> <span class="no">train</span>,
                        <span class="kw">target</span> <span class="kw">=</span> <span class="st">"survived"</span>)

<span class="no">learner</span> <span class="kw">&lt;-</span> <span class="fu">makeLearner</span>(<span class="st">"classif.ranger"</span>,
                       <span class="kw">predict.type</span> <span class="kw">=</span> <span class="st">"prob"</span>)

<span class="no">model</span> <span class="kw">&lt;-</span> <span class="fu">train</span>(<span class="no">learner</span>, <span class="no">task</span>)

<span class="co"># create an explainer for the model</span>
<span class="no">explainer</span> <span class="kw">&lt;-</span> <span class="fu">explain_mlr</span>(<span class="no">model</span>,
                         <span class="kw">data</span> <span class="kw">=</span> <span class="no">test</span>,
                         <span class="kw">y</span> <span class="kw">=</span> <span class="no">test</span>$<span class="no">survived</span>,
                         <span class="kw">label</span> <span class="kw">=</span> <span class="st">"mlr"</span>)

<span class="co"># pick observations</span>
<span class="no">new_observation</span> <span class="kw">&lt;-</span> <span class="no">test</span>[<span class="fl">1</span>:<span class="fl">2</span>, ]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">new_observation</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>)

<span class="co"># make a studio for the model</span>
<span class="fu"><a href="reference/modelStudio.html">modelStudio</a></span>(<span class="no">explainer</span>,
            <span class="no">new_observation</span>)</pre></div>
<div class="sourceCode" id="cb7"><pre class="r"><span class="co"># load packages and data</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlr3</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlr3learners</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DALEXtra</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">modelStudio</span>)

<span class="no">data</span> <span class="kw">&lt;-</span> <span class="kw pkg">DALEX</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/DALEX/man/titanic.html">titanic_imputed</a></span>

<span class="co"># split the data</span>
<span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>), <span class="fl">0.8</span>*<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>))
<span class="no">train</span> <span class="kw">&lt;-</span> <span class="no">data</span>[<span class="no">index</span>, ]
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">data</span>[-<span class="no">index</span>, ]

<span class="co"># mlr3 TaskClassif takes target as factor</span>
<span class="no">train</span>$<span class="no">survived</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">train</span>$<span class="no">survived</span>)

<span class="co"># prepare the model</span>
<span class="no">task</span> <span class="kw">&lt;-</span> <span class="no">TaskClassif</span>$<span class="fu">new</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"titanic"</span>,
                        <span class="kw">backend</span> <span class="kw">=</span> <span class="no">train</span>,
                        <span class="kw">target</span> <span class="kw">=</span> <span class="st">"survived"</span>)

<span class="no">learner</span> <span class="kw">&lt;-</span> <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>,
               <span class="kw">predict_type</span> <span class="kw">=</span> <span class="st">"prob"</span>)

<span class="no">learner</span>$<span class="fu">train</span>(<span class="no">task</span>)

<span class="co"># create an explainer for the model</span>
<span class="no">explainer</span> <span class="kw">&lt;-</span> <span class="fu">explain_mlr3</span>(<span class="no">learner</span>,
                          <span class="kw">data</span> <span class="kw">=</span> <span class="no">test</span>,
                          <span class="kw">y</span> <span class="kw">=</span> <span class="no">test</span>$<span class="no">survived</span>,
                          <span class="kw">label</span> <span class="kw">=</span> <span class="st">"mlr3"</span>)

<span class="co"># pick observations</span>
<span class="no">new_observation</span> <span class="kw">&lt;-</span> <span class="no">test</span>[<span class="fl">1</span>:<span class="fl">2</span>, ]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">new_observation</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>)

<span class="co"># make a studio for the model</span>
<span class="fu"><a href="reference/modelStudio.html">modelStudio</a></span>(<span class="no">explainer</span>,
            <span class="no">new_observation</span>)</pre></div>
</div>
<div id="h2o" class="section level3">
<h3 class="hasAnchor">
<a href="#h2o" class="anchor"></a>h2o</h3>
<div class="sourceCode" id="cb8"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DALEXtra</span>)

<span class="fu">explain_h2o</span>()</pre></div>
</div>
<div id="scikit-learn-dashboard" class="section level3">
<h3 class="hasAnchor">
<a href="#scikit-learn-dashboard" class="anchor"></a>scikit-learn <a href="https://modeloriented.github.io/modelStudio/scikit-learn.html">dashboard</a>
</h3>
<p>Use <code>pickle</code> Python module and <code>reticulate</code> R package to easily produce modelStudio for scikit-learn model.</p>
<p>In this example we fit a Pipeline MLPClassifier on the titanic data. First install the <code>dalex</code> package.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex">pip3</span> install dalex --force</span></code></pre></div>
<p>Make an explainer object in Python:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># import modules</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="im">import</span> dalex <span class="im">as</span> dx</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="im">from</span> dalex <span class="im">import</span> datasets</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPClassifier</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, LabelEncoder, OneHotEncoder</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb10-11"><a href="#cb10-11"></a></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co"># load the data</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>data <span class="op">=</span> datasets.load_titanic()</span>
<span id="cb10-14"><a href="#cb10-14"></a>X <span class="op">=</span> data.drop(columns<span class="op">=</span><span class="st">'survived'</span>)</span>
<span id="cb10-15"><a href="#cb10-15"></a>y <span class="op">=</span> data.survived</span>
<span id="cb10-16"><a href="#cb10-16"></a></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co"># make a pipeline model</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>numeric_features <span class="op">=</span> [<span class="st">'age'</span>, <span class="st">'fare'</span>, <span class="st">'sibsp'</span>, <span class="st">'parch'</span>]</span>
<span id="cb10-19"><a href="#cb10-19"></a>numeric_transformer <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb10-20"><a href="#cb10-20"></a>    (<span class="st">'imputer'</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">'median'</span>)),</span>
<span id="cb10-21"><a href="#cb10-21"></a>    (<span class="st">'scaler'</span>, StandardScaler())])</span>
<span id="cb10-22"><a href="#cb10-22"></a></span>
<span id="cb10-23"><a href="#cb10-23"></a>categorical_features <span class="op">=</span> [<span class="st">'gender'</span>, <span class="st">'class'</span>, <span class="st">'embarked'</span>]</span>
<span id="cb10-24"><a href="#cb10-24"></a>categorical_transformer <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb10-25"><a href="#cb10-25"></a>    (<span class="st">'imputer'</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">'constant'</span>, fill_value<span class="op">=</span><span class="st">'missing'</span>)),</span>
<span id="cb10-26"><a href="#cb10-26"></a>    (<span class="st">'onehot'</span>, OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">'ignore'</span>))])</span>
<span id="cb10-27"><a href="#cb10-27"></a></span>
<span id="cb10-28"><a href="#cb10-28"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb10-29"><a href="#cb10-29"></a>    transformers<span class="op">=</span>[</span>
<span id="cb10-30"><a href="#cb10-30"></a>        (<span class="st">'num'</span>, numeric_transformer, numeric_features),</span>
<span id="cb10-31"><a href="#cb10-31"></a>        (<span class="st">'cat'</span>, categorical_transformer, categorical_features)])</span>
<span id="cb10-32"><a href="#cb10-32"></a></span>
<span id="cb10-33"><a href="#cb10-33"></a></span>
<span id="cb10-34"><a href="#cb10-34"></a>clf <span class="op">=</span> Pipeline(steps<span class="op">=</span>[(<span class="st">'preprocessor'</span>, preprocessor),</span>
<span id="cb10-35"><a href="#cb10-35"></a>                      (<span class="st">'classifier'</span>, MLPClassifier(hidden_layer_sizes<span class="op">=</span>(<span class="dv">150</span>,<span class="dv">100</span>,<span class="dv">50</span>),</span>
<span id="cb10-36"><a href="#cb10-36"></a>                                                   max_iter<span class="op">=</span><span class="dv">500</span>, random_state<span class="op">=</span><span class="dv">0</span>))])</span>
<span id="cb10-37"><a href="#cb10-37"></a></span>
<span id="cb10-38"><a href="#cb10-38"></a>clf.fit(X, y)</span>
<span id="cb10-39"><a href="#cb10-39"></a></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co"># make an explainer</span></span>
<span id="cb10-41"><a href="#cb10-41"></a>explainer <span class="op">=</span> dx.Explainer(clf, X, y)</span>
<span id="cb10-42"><a href="#cb10-42"></a></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="co"># remove these functions before dump</span></span>
<span id="cb10-44"><a href="#cb10-44"></a>explainer.residual_function <span class="op">=</span> <span class="va">None</span></span>
<span id="cb10-45"><a href="#cb10-45"></a>explainer.predict_function <span class="op">=</span> <span class="va">None</span></span>
<span id="cb10-46"><a href="#cb10-46"></a></span>
<span id="cb10-47"><a href="#cb10-47"></a><span class="co"># pack the explainer into a pickle file</span></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="im">import</span> pickle        </span>
<span id="cb10-49"><a href="#cb10-49"></a>pickle_out <span class="op">=</span> <span class="bu">open</span>(<span class="st">"explainer_titanic.pickle"</span>,<span class="st">"wb"</span>)</span>
<span id="cb10-50"><a href="#cb10-50"></a>pickle.dump(explainer, pickle_out)</span>
<span id="cb10-51"><a href="#cb10-51"></a>pickle_out.close()     </span></code></pre></div>
<p>Then use modelStudio in R:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="co"># use reticulate to load the explainer from a pickle file</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">reticulate</span>)
<span class="no">explainer</span> <span class="kw">&lt;-</span> <span class="fu">py_load_object</span>(<span class="st">'explainer_titanic.pickle'</span>)

<span class="co"># make a predict_function</span>
<span class="no">predict_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">model</span>, <span class="no">data</span>) {
  <span class="kw">if</span> (<span class="st">"predict_proba"</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">model</span>)) {
    <span class="no">pred</span> <span class="kw">&lt;-</span> <span class="no">model</span>$<span class="fu">predict_proba</span>(<span class="no">data</span>)
  } <span class="kw">else</span> {
    <span class="no">pred</span> <span class="kw">&lt;-</span> <span class="no">model</span>$<span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">data</span>)
  }
  <span class="no">pred</span>
}

<span class="co"># adjust the explainer</span>
<span class="no">explainer</span>$<span class="no">predict_function</span> <span class="kw">&lt;-</span> <span class="no">predict_function</span>
<span class="no">explainer</span>$<span class="no">label</span> <span class="kw">&lt;-</span> <span class="st">'scikit-learn'</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">explainer</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">explainer</span>), <span class="st">'explainer'</span>)

<span class="co"># make a modelStudio</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">modelStudio</span>)
<span class="fu"><a href="reference/modelStudio.html">modelStudio</a></span>(<span class="no">explainer</span>)</pre></div>
</div>
<div id="lightgbm" class="section level3">
<h3 class="hasAnchor">
<a href="#lightgbm" class="anchor"></a>lightGBM</h3>
<div class="sourceCode" id="cb12"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DALEXtra</span>)

<span class="fu">explain_scikit</span>()</pre></div>
</div>
<div id="tensorflowkeras" class="section level3">
<h3 class="hasAnchor">
<a href="#tensorflowkeras" class="anchor"></a>tensorflow/keras</h3>
<div class="sourceCode" id="cb13"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DALEXtra</span>)

<span class="fu">explain_keras</span>()</pre></div>
</div>
</div>
<div id="more-resources" class="section level2">
<h2 class="hasAnchor">
<a href="#more-resources" class="anchor"></a>More Resources</h2>
<ul>
<li><p><a href="https://pbiecek.github.io/ema">Explanatory Model Analysis. Explore, Explain and Examine Predictive Models.</a></p></li>
<li><p><a href="https://modeloriented.github.io/modelStudio/articles/vignette_modelStudio.html">Read the vignette: modelStudio - perks and features</a></p></li>
<li><p><a href="misc/MLinPL2019_modelStudio_poster.pdf">Conference Poster about modelStudio</a></p></li>
</ul>
<!--  - [Article about modelStudio](https://joss.theoj.org/papers/10.21105/joss.01798) --><ul>
<li><a href="NEWS.html">News</a></li>
</ul>
</div>
<div id="save-and-share" class="section level2">
<h2 class="hasAnchor">
<a href="#save-and-share" class="anchor"></a>Save and Share</h2>
<p>Save <code>modelStudio</code> as a HTML file using buttons on the top of the RStudio Viewer or with <a href="https://rstudio.github.io/r2d3/articles/publishing.html#save-as-html"><code><a href="https://rdrr.io/pkg/r2d3/man/save_d3_html.html">r2d3::save_d3_html()</a></code></a>.</p>
<p align="center">
<img src="reference/figures/controls.png"></p>
</div>
<div id="acknowledgments" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h2>
<p>Work on this package was financially supported by the <code>NCN Opus grant 2016/21/B/ST6/02176</code>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=modelStudio">https://​cloud.r-project.org/​package=modelStudio</a>
</li>
<li>Browse source code at <br><a href="https://github.com/ModelOriented/modelStudio/">https://​github.com/​ModelOriented/​modelStudio/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/ModelOriented/modelStudio/issues">https://​github.com/​ModelOriented/​modelStudio/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing modelStudio</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Hubert Baniecki <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-6661-5364" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Przemyslaw Biecek <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8423-1823" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=modelStudio"><img src="http://www.r-pkg.org/badges/version/modelStudio" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://github.com/ModelOriented/modelStudio/actions?query=workflow%3AR-CMD-check"><img src="https://github.com/ModelOriented/modelStudio/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/github/ModelOriented/modelStudio?branch=master"><img src="https://codecov.io/gh/ModelOriented/modelStudio/branch/master/graph/badge.svg" alt="Coverage Status"></a></li>
<li><a href="http://drwhy.ai/#AutoMat"><img src="https://img.shields.io/badge/DrWhy-AutoMat-ae2c87" alt="DrWhy-eXtrAI"></a></li>
<li><a href="https://joss.theoj.org/papers/9eec8c9d1969fbd44b3ea438a74af911"><img src="https://joss.theoj.org/papers/9eec8c9d1969fbd44b3ea438a74af911/status.svg" alt="JOSS-status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Hubert Baniecki, Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
